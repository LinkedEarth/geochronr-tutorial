<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Regression and Calibration-in-time | Time-uncertain data analysis in R</title>
  <meta name="description" content="This book covers time-uncertain data analysis in R, primarily relying on the geoChronR package" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Regression and Calibration-in-time | Time-uncertain data analysis in R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book covers time-uncertain data analysis in R, primarily relying on the geoChronR package" />
  <meta name="github-repo" content="linkedearth/time-uncertain-data-analysis-in-R" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Regression and Calibration-in-time | Time-uncertain data analysis in R" />
  
  <meta name="twitter:description" content="This book covers time-uncertain data analysis in R, primarily relying on the geoChronR package" />
  

<meta name="author" content="Nick McKay" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="pca.html"/>
<link rel="next" href="spectral.html"/>
<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Time-uncertain Data Analysis in R</a></li>
<li><a href="http://nickmckay.github.io/GeoChronR">geoChronR manual</a></li>
<li><a href="http://linked.earth">LinkedEarth Home </a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome!</a></li>
<li class="chapter" data-level="2" data-path="installation.html"><a href="installation.html"><i class="fa fa-check"></i><b>2</b> Installing the software you need</a>
<ul>
<li class="chapter" data-level="2.1" data-path="installation.html"><a href="installation.html#installing-lipdr"><i class="fa fa-check"></i><b>2.1</b> Installing lipdR</a></li>
<li class="chapter" data-level="2.2" data-path="installation.html"><a href="installation.html#installing-geochronr"><i class="fa fa-check"></i><b>2.2</b> Installing geoChronR</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>3</b> Data in geoChronR</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data.html"><a href="data.html#loading-a-lipd-file"><i class="fa fa-check"></i><b>3.1</b> Loading a LiPD file</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="data.html"><a href="data.html#selectData"><i class="fa fa-check"></i><b>3.1.1</b> Extract a variable from a LiPD object</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="data.html"><a href="data.html#loading-multiple-lipd-datasets"><i class="fa fa-check"></i><b>3.2</b> Loading multiple LiPD datasets</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="data.html"><a href="data.html#filtering"><i class="fa fa-check"></i><b>3.2.1</b> Filtering</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="agemodelling.html"><a href="agemodelling.html"><i class="fa fa-check"></i><b>4</b> Age modelling in geoChronR</a>
<ul>
<li class="chapter" data-level="4.1" data-path="agemodelling.html"><a href="agemodelling.html#bacon"><i class="fa fa-check"></i><b>4.1</b> Bacon</a></li>
<li class="chapter" data-level="4.2" data-path="agemodelling.html"><a href="agemodelling.html#bchron"><i class="fa fa-check"></i><b>4.2</b> BChron</a></li>
<li class="chapter" data-level="4.3" data-path="agemodelling.html"><a href="agemodelling.html#oxcal"><i class="fa fa-check"></i><b>4.3</b> OxCal</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="agemodelling.html"><a href="agemodelling.html#lets-compare-these-models."><i class="fa fa-check"></i><b>4.3.1</b> Let’s compare these models.</a></li>
<li class="chapter" data-level="4.3.2" data-path="agemodelling.html"><a href="agemodelling.html#creating-a-multimodel-ensemble"><i class="fa fa-check"></i><b>4.3.2</b> Creating a multimodel ensemble</a></li>
<li class="chapter" data-level="4.3.3" data-path="agemodelling.html"><a href="agemodelling.html#mapping-the-age-ensemble-to-the-paleodata-measurements"><i class="fa fa-check"></i><b>4.3.3</b> Mapping the age ensemble to the paleoData measurements</a></li>
<li class="chapter" data-level="4.3.4" data-path="agemodelling.html"><a href="agemodelling.html#creating-a-timeseries-plot-as-a-spaghetti-plot-of-lines"><i class="fa fa-check"></i><b>4.3.4</b> Creating a timeseries plot as a spaghetti plot of lines</a></li>
<li class="chapter" data-level="4.3.5" data-path="agemodelling.html"><a href="agemodelling.html#creating-a-timeseries-plot-with-a-ribbon-confidence-intervals"><i class="fa fa-check"></i><b>4.3.5</b> Creating a timeseries plot with a ribbon confidence intervals</a></li>
<li class="chapter" data-level="4.3.6" data-path="agemodelling.html"><a href="agemodelling.html#combining-the-two-kinds-of-timeseries-plots"><i class="fa fa-check"></i><b>4.3.6</b> Combining the two kinds of timeseries plots</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="agemodelling.html"><a href="agemodelling.html#banded-age-modelling"><i class="fa fa-check"></i><b>4.4</b> Banded Age Modelling</a></li>
<li class="chapter" data-level="4.5" data-path="agemodelling.html"><a href="agemodelling.html#chapter-project"><i class="fa fa-check"></i><b>4.5</b> Chapter project</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="correlation.html"><a href="correlation.html"><i class="fa fa-check"></i><b>5</b> Correlation</a>
<ul>
<li class="chapter" data-level="5.1" data-path="correlation.html"><a href="correlation.html#first-look"><i class="fa fa-check"></i><b>5.1</b> First look</a></li>
<li class="chapter" data-level="5.2" data-path="correlation.html"><a href="correlation.html#correlateResponsibly"><i class="fa fa-check"></i><b>5.2</b> How to correlate responsibly</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="correlation.html"><a href="correlation.html#correlation-1"><i class="fa fa-check"></i><b>5.2.1</b> Correlation</a></li>
<li class="chapter" data-level="5.2.2" data-path="correlation.html"><a href="correlation.html#binning"><i class="fa fa-check"></i><b>5.2.2</b> Binning</a></li>
<li class="chapter" data-level="5.2.3" data-path="correlation.html"><a href="correlation.html#autocorrelation"><i class="fa fa-check"></i><b>5.2.3</b> Autocorrelation</a></li>
<li class="chapter" data-level="5.2.4" data-path="correlation.html"><a href="correlation.html#test-multiplicity"><i class="fa fa-check"></i><b>5.2.4</b> Test multiplicity</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="correlation.html"><a href="correlation.html#the-corens-function"><i class="fa fa-check"></i><b>5.3</b> The corEns() function</a></li>
<li class="chapter" data-level="5.4" data-path="correlation.html"><a href="correlation.html#plotting-the-ensemble-correlation-results"><i class="fa fa-check"></i><b>5.4</b> Plotting the ensemble correlation results</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="correlation.html"><a href="correlation.html#significance-testing-options"><i class="fa fa-check"></i><b>5.4.1</b> Significance testing options</a></li>
<li class="chapter" data-level="5.4.2" data-path="correlation.html"><a href="correlation.html#false-discovery-rate-testing"><i class="fa fa-check"></i><b>5.4.2</b> False-discovery rate testing</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="correlation.html"><a href="correlation.html#judging-the-overall-significance-of-an-age-uncertain-correlation"><i class="fa fa-check"></i><b>5.5</b> Judging the overall significance of an age-uncertain correlation</a></li>
<li class="chapter" data-level="5.6" data-path="correlation.html"><a href="correlation.html#chapter-project-1"><i class="fa fa-check"></i><b>5.6</b> Chapter Project</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="pca.html"><a href="pca.html"><i class="fa fa-check"></i><b>6</b> Principal Components Analysis</a>
<ul>
<li class="chapter" data-level="6.1" data-path="pca.html"><a href="pca.html#lets-explore-these-data"><i class="fa fa-check"></i><b>6.1</b> Let’s explore these data!</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="pca.html"><a href="pca.html#make-a-map"><i class="fa fa-check"></i><b>6.1.1</b> Make a map</a></li>
<li class="chapter" data-level="6.1.2" data-path="pca.html"><a href="pca.html#grab-the-age-ensembles-for-each-record."><i class="fa fa-check"></i><b>6.1.2</b> Grab the age ensembles for each record.</a></li>
<li class="chapter" data-level="6.1.3" data-path="pca.html"><a href="pca.html#plot-some-summary-statistics"><i class="fa fa-check"></i><b>6.1.3</b> Plot some summary statistics</a></li>
<li class="chapter" data-level="6.1.4" data-path="pca.html"><a href="pca.html#plot-the-data"><i class="fa fa-check"></i><b>6.1.4</b> Plot the data</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="pca.html"><a href="pca.html#filter-the-data"><i class="fa fa-check"></i><b>6.2</b> Filter the data</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="pca.html"><a href="pca.html#plot-the-data-again-plotagain"><i class="fa fa-check"></i><b>6.2.1</b> Plot the data again (#plotAgain)</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="pca.html"><a href="pca.html#calculate-an-ensemble-pca"><i class="fa fa-check"></i><b>6.3</b> Calculate an ensemble PCA</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="pca.html"><a href="pca.html#plot-the-ensemble-pca-results"><i class="fa fa-check"></i><b>6.3.1</b> Plot the ensemble PCA results</a></li>
<li class="chapter" data-level="6.3.2" data-path="pca.html"><a href="pca.html#data-weighting"><i class="fa fa-check"></i><b>6.3.2</b> Data weighting</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="pca.html"><a href="pca.html#ensemble-pca-using-a-correlation-matrix."><i class="fa fa-check"></i><b>6.4</b> Ensemble PCA using a correlation matrix.</a></li>
<li class="chapter" data-level="6.5" data-path="pca.html"><a href="pca.html#chapter-project-2"><i class="fa fa-check"></i><b>6.5</b> Chapter project</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="regression-and-calibration-in-time.html"><a href="regression-and-calibration-in-time.html"><i class="fa fa-check"></i><b>7</b> Regression and Calibration-in-time</a>
<ul>
<li class="chapter" data-level="7.1" data-path="regression-and-calibration-in-time.html"><a href="regression-and-calibration-in-time.html#load-the-lipd-file"><i class="fa fa-check"></i><b>7.1</b> Load the LiPD file</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="regression-and-calibration-in-time.html"><a href="regression-and-calibration-in-time.html#check-out-the-contents"><i class="fa fa-check"></i><b>7.1.1</b> Check out the contents</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="regression-and-calibration-in-time.html"><a href="regression-and-calibration-in-time.html#create-an-age-model"><i class="fa fa-check"></i><b>7.2</b> Create an age model</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="regression-and-calibration-in-time.html"><a href="regression-and-calibration-in-time.html#and-plot-the-ensemble-output"><i class="fa fa-check"></i><b>7.2.1</b> And plot the ensemble output</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="regression-and-calibration-in-time.html"><a href="regression-and-calibration-in-time.html#prepare-the-data"><i class="fa fa-check"></i><b>7.3</b> Prepare the data</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="regression-and-calibration-in-time.html"><a href="regression-and-calibration-in-time.html#map-the-age-ensemble-to-the-paleodata-table"><i class="fa fa-check"></i><b>7.3.1</b> Map the age ensemble to the paleodata table</a></li>
<li class="chapter" data-level="7.3.2" data-path="regression-and-calibration-in-time.html"><a href="regression-and-calibration-in-time.html#select-the-paleodata-age-ensemble-and-rabd-data-that-wed-like-to-regress-and-calibrate"><i class="fa fa-check"></i><b>7.3.2</b> Select the paleodata age ensemble, and RABD data that we’d like to regress and calibrate</a></li>
<li class="chapter" data-level="7.3.3" data-path="regression-and-calibration-in-time.html"><a href="regression-and-calibration-in-time.html#now-load-in-the-instrumental-data"><i class="fa fa-check"></i><b>7.3.3</b> Now load in the instrumental data</a></li>
<li class="chapter" data-level="7.3.4" data-path="regression-and-calibration-in-time.html"><a href="regression-and-calibration-in-time.html#check-agetime-units-before-proceeding"><i class="fa fa-check"></i><b>7.3.4</b> Check age/time units before proceeding</a></li>
<li class="chapter" data-level="7.3.5" data-path="regression-and-calibration-in-time.html"><a href="regression-and-calibration-in-time.html#create-a-variable-list-for-the-instrumental-data"><i class="fa fa-check"></i><b>7.3.5</b> Create a “variable list” for the instrumental data</a></li>
<li class="chapter" data-level="7.3.6" data-path="regression-and-calibration-in-time.html"><a href="regression-and-calibration-in-time.html#calculate-an-ensemble-correlation-between-the-rabd-and-local-summer-temperature-data"><i class="fa fa-check"></i><b>7.3.6</b> Calculate an ensemble correlation between the RABD and local summer temperature data</a></li>
<li class="chapter" data-level="7.3.7" data-path="regression-and-calibration-in-time.html"><a href="regression-and-calibration-in-time.html#and-plot-the-output"><i class="fa fa-check"></i><b>7.3.7</b> And plot the output</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="regression-and-calibration-in-time.html"><a href="regression-and-calibration-in-time.html#perform-ensemble-regression"><i class="fa fa-check"></i><b>7.4</b> Perform ensemble regression</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="regression-and-calibration-in-time.html"><a href="regression-and-calibration-in-time.html#and-plot-the-output-1"><i class="fa fa-check"></i><b>7.4.1</b> And plot the output</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="regression-and-calibration-in-time.html"><a href="regression-and-calibration-in-time.html#chapter-project-3"><i class="fa fa-check"></i><b>7.5</b> Chapter project</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="spectral.html"><a href="spectral.html"><i class="fa fa-check"></i><b>8</b> Spectral Analysis</a>
<ul>
<li class="chapter" data-level="8.0.1" data-path="spectral.html"><a href="spectral.html#multi-taper-method"><i class="fa fa-check"></i><b>8.0.1</b> Multi-taper Method</a></li>
<li class="chapter" data-level="8.0.2" data-path="spectral.html"><a href="spectral.html#weighted-wavelet-z-transform-nuspectral"><i class="fa fa-check"></i><b>8.0.2</b> Weighted Wavelet Z-transform (<em>nuspectral</em>)</a></li>
<li class="chapter" data-level="8.1" data-path="spectral.html"><a href="spectral.html#time-uncertain-spectral-analysis"><i class="fa fa-check"></i><b>8.1</b> Time-uncertain spectral analysis</a></li>
<li class="chapter" data-level="8.2" data-path="spectral.html"><a href="spectral.html#conclusion"><i class="fa fa-check"></i><b>8.2</b> Conclusion</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Time-uncertain data analysis in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="regression-and-calibration-in-time" class="section level1" number="7">
<h1><span class="header-section-number">Chapter 7</span> Regression and Calibration-in-time</h1>
<p>In this chapter, we will replicate the analysis of <span class="citation">(<a href="#ref-Boldt2015" role="doc-biblioref">Boldt et al. 2015</a>)</span>, performing age-uncertain calibration-in-time on a chlorophyll reflectance record from northern Alaska, using geoChronR.</p>
<p>The challenge of age-uncertain calibration-in-time is that age uncertainty affects both the calibration model (the relation between the proxy data and instrumental data) and the reconstruction (the timing of events in the reconstruction). geoChronR simplifies handling these issues.</p>
<p>Let’s start by loading the packages we’ll need.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="regression-and-calibration-in-time.html#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lipdR) <span class="co">#to read and write LiPD files</span></span>
<span id="cb108-2"><a href="regression-and-calibration-in-time.html#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(geoChronR) <span class="co">#of course</span></span>
<span id="cb108-3"><a href="regression-and-calibration-in-time.html#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr) <span class="co">#to load in the instrumental data we need</span></span>
<span id="cb108-4"><a href="regression-and-calibration-in-time.html#cb108-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2) <span class="co">#for plotting</span></span></code></pre></div>
<div id="load-the-lipd-file" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> Load the LiPD file</h2>
<p>OK, we’ll begin by loading in the Kurupa Lake record from <span class="citation">(<a href="#ref-Boldt2015" role="doc-biblioref">Boldt et al. 2015</a>)</span>.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="regression-and-calibration-in-time.html#cb109-1" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> lipdR<span class="sc">::</span><span class="fu">readLipd</span>(<span class="st">&quot;http://lipdverse.org/geoChronR-examples/Kurupa.Boldt.2015.lpd&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;reading: Kurupa.Boldt.2015.lpd&quot;</code></pre>
<div id="check-out-the-contents" class="section level3" number="7.1.1">
<h3><span class="header-section-number">7.1.1</span> Check out the contents</h3>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="regression-and-calibration-in-time.html#cb111-1" aria-hidden="true" tabindex="-1"></a>sp <span class="ot">&lt;-</span> <span class="fu">plotSummary</span>(K,<span class="at">paleo.data.var =</span> <span class="st">&quot;RABD&quot;</span>,<span class="at">summary.font.size =</span> <span class="dv">6</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Found it! Moving on...&quot;
## [1] &quot;Found it! Moving on...&quot;
## [1] &quot;Found it! Moving on...&quot;
## [1] &quot;Found it! Moving on...&quot;
## [1] &quot;Found it! Moving on...&quot;</code></pre>
<p><img src="Time-uncertain-data-analysis-in-R_files/figure-html/unnamed-chunk-64-1.png" width="672" /></p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="regression-and-calibration-in-time.html#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sp)</span></code></pre></div>
<pre><code>## TableGrob (4 x 4) &quot;arrange&quot;: 4 grobs
##   z     cells    name                    grob
## 1 1 (1-1,1-2) arrange gTree[GRID.gTree.19188]
## 2 2 (1-2,3-4) arrange          gtable[layout]
## 3 3 (2-4,1-2) arrange          gtable[layout]
## 4 4 (3-4,3-4) arrange          gtable[layout]</code></pre>
</div>
</div>
<div id="create-an-age-model" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> Create an age model</h2>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="regression-and-calibration-in-time.html#cb115-1" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="fu">runBacon</span>(K,</span>
<span id="cb115-2"><a href="regression-and-calibration-in-time.html#cb115-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">lab.id.var =</span> <span class="st">&#39;labID&#39;</span>, </span>
<span id="cb115-3"><a href="regression-and-calibration-in-time.html#cb115-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">age.14c.var =</span> <span class="st">&#39;age14C&#39;</span>, </span>
<span id="cb115-4"><a href="regression-and-calibration-in-time.html#cb115-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">age.14c.uncertainty.var =</span> <span class="st">&#39;age14CUncertainty&#39;</span>,</span>
<span id="cb115-5"><a href="regression-and-calibration-in-time.html#cb115-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">age.var =</span> <span class="st">&#39;age&#39;</span>, </span>
<span id="cb115-6"><a href="regression-and-calibration-in-time.html#cb115-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">age.uncertainty.var =</span> <span class="st">&#39;ageUncertainty&#39;</span>, </span>
<span id="cb115-7"><a href="regression-and-calibration-in-time.html#cb115-7" aria-hidden="true" tabindex="-1"></a>              <span class="at">depth.var =</span> <span class="st">&#39;depth&#39;</span>, </span>
<span id="cb115-8"><a href="regression-and-calibration-in-time.html#cb115-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">reservoir.age.14c.var =</span> <span class="cn">NULL</span>, </span>
<span id="cb115-9"><a href="regression-and-calibration-in-time.html#cb115-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">reservoir.age.14c.uncertainty.var =</span> <span class="cn">NULL</span>, </span>
<span id="cb115-10"><a href="regression-and-calibration-in-time.html#cb115-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">rejected.ages.var =</span> <span class="cn">NULL</span>,</span>
<span id="cb115-11"><a href="regression-and-calibration-in-time.html#cb115-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">bacon.acc.mean =</span> <span class="dv">10</span>,</span>
<span id="cb115-12"><a href="regression-and-calibration-in-time.html#cb115-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">bacon.thick =</span> <span class="dv">7</span>,</span>
<span id="cb115-13"><a href="regression-and-calibration-in-time.html#cb115-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">ask =</span> <span class="cn">FALSE</span>,</span>
<span id="cb115-14"><a href="regression-and-calibration-in-time.html#cb115-14" aria-hidden="true" tabindex="-1"></a>              <span class="at">bacon.dir =</span> <span class="st">&quot;~/Cores&quot;</span>,</span>
<span id="cb115-15"><a href="regression-and-calibration-in-time.html#cb115-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">suggest =</span> <span class="cn">FALSE</span>,</span>
<span id="cb115-16"><a href="regression-and-calibration-in-time.html#cb115-16" aria-hidden="true" tabindex="-1"></a>              <span class="at">close.connection =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<div class="blackbox">
<div class="exercise">
<p><span id="exr:reg-ex-1" class="exercise"><strong>Exercise 7.1  </strong></span>In this chapter, the exercises will have conduct the analysis in a parallel universe, where you make different, but reasonable choices and see what happens.</p>
<p>First, create the best age model you can using either Bchron or Oxcal.</p>
</div>
</div>
<div id="and-plot-the-ensemble-output" class="section level3" number="7.2.1">
<h3><span class="header-section-number">7.2.1</span> And plot the ensemble output</h3>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="regression-and-calibration-in-time.html#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotChron</span>(K,<span class="at">age.var =</span> <span class="st">&quot;ageEnsemble&quot;</span>,<span class="at">dist.scale =</span> <span class="fl">0.2</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Found it! Moving on...&quot;
## [1] &quot;Found it! Moving on...&quot;
## [1] &quot;plotting your chron ensemble. This make take a few seconds...&quot;</code></pre>
<pre><code>## Scale for &#39;x&#39; is already present. Adding another scale for &#39;x&#39;, which will replace the existing scale.</code></pre>
<p><img src="Time-uncertain-data-analysis-in-R_files/figure-html/unnamed-chunk-65-1.png" width="672" /></p>
<div class="blackbox">
<div class="exercise">
<p><span id="exr:reg-ex-2" class="exercise"><strong>Exercise 7.2  </strong></span>Plot your model. How does it compare to the Bacon model?</p>
</div>
</div>
</div>
</div>
<div id="prepare-the-data" class="section level2" number="7.3">
<h2><span class="header-section-number">7.3</span> Prepare the data</h2>
<div id="map-the-age-ensemble-to-the-paleodata-table" class="section level3" number="7.3.1">
<h3><span class="header-section-number">7.3.1</span> Map the age ensemble to the paleodata table</h3>
<p>This is to get ensemble age estimates for each depth in the paleoData measurement table</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="regression-and-calibration-in-time.html#cb119-1" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="fu">mapAgeEnsembleToPaleoData</span>(K,<span class="at">age.var =</span> <span class="st">&quot;ageEnsemble&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Kurupa.Boldt.2015&quot;
## [1] &quot;Looking for age ensemble....&quot;
## [1] &quot;Found it! Moving on...&quot;
## [1] &quot;Found it! Moving on...&quot;
## [1] &quot;getting depth from the paleodata table...&quot;
## [1] &quot;Found it! Moving on...&quot;</code></pre>
</div>
<div id="select-the-paleodata-age-ensemble-and-rabd-data-that-wed-like-to-regress-and-calibrate" class="section level3" number="7.3.2">
<h3><span class="header-section-number">7.3.2</span> Select the paleodata age ensemble, and RABD data that we’d like to regress and calibrate</h3>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="regression-and-calibration-in-time.html#cb121-1" aria-hidden="true" tabindex="-1"></a>kae <span class="ot">&lt;-</span>  <span class="fu">selectData</span>(K,<span class="st">&quot;ageEnsemble&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Found it! Moving on...&quot;</code></pre>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="regression-and-calibration-in-time.html#cb123-1" aria-hidden="true" tabindex="-1"></a>rabd <span class="ot">&lt;-</span> <span class="fu">selectData</span>(K,<span class="st">&quot;RABD&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Found it! Moving on...&quot;</code></pre>
</div>
<div id="now-load-in-the-instrumental-data" class="section level3" number="7.3.3">
<h3><span class="header-section-number">7.3.3</span> Now load in the instrumental data</h3>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="regression-and-calibration-in-time.html#cb125-1" aria-hidden="true" tabindex="-1"></a>kurupa.instrumental <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">&quot;http://lipdverse.org/geoChronR-examples/KurupaInstrumental.csv&quot;</span>)</span></code></pre></div>
<pre><code>## Rows: 134 Columns: 2</code></pre>
<pre><code>## ── Column specification ──────────────────────────────────────────────────────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## dbl (2): Year (AD), JJAS Temperature (deg C)</code></pre>
<pre><code>## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div id="check-agetime-units-before-proceeding" class="section level3" number="7.3.4">
<h3><span class="header-section-number">7.3.4</span> Check age/time units before proceeding</h3>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="regression-and-calibration-in-time.html#cb129-1" aria-hidden="true" tabindex="-1"></a>kae<span class="sc">$</span>units</span></code></pre></div>
<pre><code>## [1] &quot;yr BP&quot;</code></pre>
<p>yep, we need to convert the units from BP to AD</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="regression-and-calibration-in-time.html#cb131-1" aria-hidden="true" tabindex="-1"></a>kae <span class="ot">&lt;-</span> <span class="fu">convertBP2AD</span>(kae)</span></code></pre></div>
</div>
<div id="create-a-variable-list-for-the-instrumental-data" class="section level3" number="7.3.5">
<h3><span class="header-section-number">7.3.5</span> Create a “variable list” for the instrumental data</h3>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="regression-and-calibration-in-time.html#cb132-1" aria-hidden="true" tabindex="-1"></a>kyear <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb132-2"><a href="regression-and-calibration-in-time.html#cb132-2" aria-hidden="true" tabindex="-1"></a>kyear<span class="sc">$</span>values <span class="ot">&lt;-</span> kurupa.instrumental[,<span class="dv">1</span>]</span>
<span id="cb132-3"><a href="regression-and-calibration-in-time.html#cb132-3" aria-hidden="true" tabindex="-1"></a>kyear<span class="sc">$</span>variableName <span class="ot">&lt;-</span> <span class="st">&quot;year&quot;</span></span>
<span id="cb132-4"><a href="regression-and-calibration-in-time.html#cb132-4" aria-hidden="true" tabindex="-1"></a>kyear<span class="sc">$</span>units <span class="ot">&lt;-</span> <span class="st">&quot;AD&quot;</span></span>
<span id="cb132-5"><a href="regression-and-calibration-in-time.html#cb132-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-6"><a href="regression-and-calibration-in-time.html#cb132-6" aria-hidden="true" tabindex="-1"></a>kinst <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb132-7"><a href="regression-and-calibration-in-time.html#cb132-7" aria-hidden="true" tabindex="-1"></a>kinst<span class="sc">$</span>values <span class="ot">&lt;-</span> kurupa.instrumental[,<span class="dv">2</span>]</span>
<span id="cb132-8"><a href="regression-and-calibration-in-time.html#cb132-8" aria-hidden="true" tabindex="-1"></a>kinst<span class="sc">$</span>variableName <span class="ot">&lt;-</span> <span class="st">&quot;Temperature&quot;</span></span>
<span id="cb132-9"><a href="regression-and-calibration-in-time.html#cb132-9" aria-hidden="true" tabindex="-1"></a>kinst<span class="sc">$</span>units <span class="ot">&lt;-</span> <span class="st">&quot;deg (C)&quot;</span></span></code></pre></div>
<div class="blackbox">
<div class="exercise">
<p><span id="exr:reg-ex-3" class="exercise"><strong>Exercise 7.3  </strong></span>Repeat all of this prep work, including mapping the age uncertainties and extracting the variables.</p>
</div>
</div>
</div>
<div id="calculate-an-ensemble-correlation-between-the-rabd-and-local-summer-temperature-data" class="section level3" number="7.3.6">
<h3><span class="header-section-number">7.3.6</span> Calculate an ensemble correlation between the RABD and local summer temperature data</h3>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="regression-and-calibration-in-time.html#cb133-1" aria-hidden="true" tabindex="-1"></a>corout <span class="ot">&lt;-</span> <span class="fu">corEns</span>(kae,rabd,kyear,kinst,<span class="at">bin.step=</span><span class="dv">2</span>,<span class="at">percentiles =</span> <span class="fu">c</span>(.<span class="dv">05</span>,.<span class="dv">5</span>,.<span class="dv">95</span> ))</span></code></pre></div>
<div class="blackbox">
<div class="exercise">
<p><span id="exr:reg-ex-4" class="exercise"><strong>Exercise 7.4  </strong></span>Calculate the correlation ensemble, but you decide to use 5-year bins instead of 2-year bins.</p>
</div>
</div>
</div>
<div id="and-plot-the-output" class="section level3" number="7.3.7">
<h3><span class="header-section-number">7.3.7</span> And plot the output</h3>
<p>Note that here we use the “Effective-N” significance option as we mimic the Boldt et al. (2015) paper.</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="regression-and-calibration-in-time.html#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotCorEns</span>(corout,<span class="at">significance.option =</span> <span class="st">&quot;eff-n&quot;</span>)</span></code></pre></div>
<p><img src="Time-uncertain-data-analysis-in-R_files/figure-html/unnamed-chunk-73-1.png" width="672" /></p>
<p>Mixed results. But encouraging enough to move forward.</p>
<div class="blackbox">
<div class="exercise">
<p><span id="exr:reg-ex-5" class="exercise"><strong>Exercise 7.5  </strong></span>After reading Chapter <a href="#corr"><strong>??</strong></a>, you know that the isospectral method is usually more reliable. Use that instead.</p>
</div>
</div>
</div>
</div>
<div id="perform-ensemble-regression" class="section level2" number="7.4">
<h2><span class="header-section-number">7.4</span> Perform ensemble regression</h2>
<p>OK, you’ve convinced yourself that you want to use RABD to model temperature back through time. We can do this simply (perhaps naively) with regression, and lets do it with age uncertainty, both in the building of the model, and the reconstructing</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="regression-and-calibration-in-time.html#cb135-1" aria-hidden="true" tabindex="-1"></a>regout <span class="ot">&lt;-</span> <span class="fu">regressEns</span>(<span class="at">time.x =</span> kae,</span>
<span id="cb135-2"><a href="regression-and-calibration-in-time.html#cb135-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values.x =</span> rabd,</span>
<span id="cb135-3"><a href="regression-and-calibration-in-time.html#cb135-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">time.y =</span>kyear,</span>
<span id="cb135-4"><a href="regression-and-calibration-in-time.html#cb135-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values.y =</span>kinst,</span>
<span id="cb135-5"><a href="regression-and-calibration-in-time.html#cb135-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">bin.step=</span><span class="dv">3</span>,</span>
<span id="cb135-6"><a href="regression-and-calibration-in-time.html#cb135-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">gaussianize =</span> <span class="cn">FALSE</span>,</span>
<span id="cb135-7"><a href="regression-and-calibration-in-time.html#cb135-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">recon.bin.vec =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4010</span>,<span class="dv">2010</span>,<span class="at">by=</span><span class="dv">20</span>))</span></code></pre></div>
<div class="blackbox">
<div class="exercise">
<p><span id="exr:reg-ex-6" class="exercise"><strong>Exercise 7.6  </strong></span>Again, use 5-year time steps, and also gaussianize to avoid the potential impact of skewed data</p>
</div>
</div>
<div id="and-plot-the-output-1" class="section level3" number="7.4.1">
<h3><span class="header-section-number">7.4.1</span> And plot the output</h3>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="regression-and-calibration-in-time.html#cb136-1" aria-hidden="true" tabindex="-1"></a>regPlots <span class="ot">&lt;-</span> <span class="fu">plotRegressEns</span>(regout,<span class="at">alp =</span> <span class="fl">0.01</span>,<span class="at">font.size =</span> <span class="dv">8</span>)</span></code></pre></div>
<p><img src="Time-uncertain-data-analysis-in-R_files/figure-html/unnamed-chunk-75-1.png" width="672" /></p>
<p>This result is consistent with that produced by Boldt et al., (2015), and was much simpler to produce with geoChronR.</p>
</div>
</div>
<div id="chapter-project-3" class="section level2" number="7.5">
<h2><span class="header-section-number">7.5</span> Chapter project</h2>
<div class="blackbox">
<div class="exercise">
<p><span id="exr:reg-ex-7" class="exercise"><strong>Exercise 7.7  </strong></span>Plot your results. How did making different, reasonable (perhaps even better?) choices affect the final outcome of the regression?</p>
</div>
</div>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Boldt2015" class="csl-entry">
Boldt, Brandon R., Darrell S. Kaufman, Nicholas P. McKay, and Jason P. Briner. 2015. <span>“Holocene Summer Temperature Reconstruction from Sedimentary Chlorophyll Content, with Treatment of Age Uncertainties, Kurupa Lake, Arctic Alaska.”</span> <em>The Holocene</em>, January. <a href="https://doi.org/10.1177/0959683614565929">https://doi.org/10.1177/0959683614565929</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="pca.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="spectral.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Time-uncertain-data-analysis-in-R.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
